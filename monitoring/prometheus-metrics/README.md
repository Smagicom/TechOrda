# prometheus-metrics

В Prometheus есть 4 типа метрик.

<table>
<tr>
    <th>Название</th>
    <th>Описание</th>
</tr>
<tr>
    <td>Счетчик (англ. "Counter")</td>
    <td>
        Представляет из себя счетчик. Значение может только увеличиваться<br>
        либо быть сброшено на 0.<br>
        Обычно используют для того, чтобы показать сколько было сделано запросов,<br>
        сколько было ошибок и т.д.<br>    
        Не используйте Counter для значений, которые могут уменьшаться.
    </td>
</tr>
<tr>
    <td>Измеритель (англ. "Gauge")</td>
    <td>
        Представляет из себя числовое значение, которое может увеличиваться и<br>
        уменьшаться.<br>
        Gauge используют, например, для измерения температуры процессора, потребление <br>
        ОЗУ - для значений, которые могут как расти, так и уменьшаться.
    </td>
</tr>
<tr>
    <td>Гистограмма (англ. "Histogram")</td>
    <td>
        Гистограмма собирает измерения и расставляет по бакетам. Это нужно, чтобы<br>
        отслеживать кол-во измерений в определенной пропорции. Звучит сложно,<br>
        однако на деле является очень полезной метрикой.<br>
        Гистограмма агрегирует данные, чтобы иметь представление<br>
        о метриках в общем виде.<br>
        Если нужно работать с пропорциями либо с процентажами, то используйте гистрограммы.
    </td>
</tr>
<tr>
    <td>Сводка (англ. "Summary")</td>
    <td>
        Сводка - это расширенные гистограммы. Имеет такой же функционал, однако<br>
        дополнительно показывает еще квантили за период времени.<br>
    </td>
</tr>
</table>

## Нотация

Нотация - это формат метрики, то как они формируются и отображаются.

```ini
<metric_name> <value>
```

Выше представлено как отображается метрика. Она имеет вид ключ-значение, где слева название метрики, а
справа его текущее значение.

Каждая метрика может иметь дополнительный набор параметров. Это позволяет четко
разделять обязанности метрики и определять кто за что отвечает.

```ini
<metric name>{<label name>=<label value>, ...} <value>
```

Как показано в нотации выше, дополнительные параметры пишутся внутри `{` фигурных скобок `}`.
Пример того, как это может быть использовано:

```ini
http_requests_total{method="GET", handler="/reverse"} 5
http_requests_total{method="PATCH", handler="/list"} 34
http_requests_total{method="GET", handler="/list"} 7
http_requests_total{method="POST", handler="/calculator"} 12
```

Из примера выше мы можем понять, что метрика `http_requests_total` отвечает за кол-во выполненных запросов
на сервер.

Разберем что означает одна из линий.

```ini
http_requests_total{method="GET", handler="/reverse"} 5
```

Данная метрика говорит, что на путь `/reverse` с методом `GET` на данный момент было выполнено
5 запросов. Чем больше запросов будет приходить, тем больше это число будет увеличиваться.

### Полезное

- [Полное руководство по Prometheus](https://slurm.io/tpost/egiyf928zy-polnoe-rukovodstvo-po-prometheus)
